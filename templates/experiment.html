<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ experiment.name }} - SpectraML</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body class="bg-gray-50">
    <!-- Navigation -->
    <nav class="bg-indigo-600 shadow-md">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex">
                    <div class="flex-shrink-0 flex items-center">
                        <span class="text-white text-2xl font-bold">SpectraML</span>
                    </div>
                    <div class="hidden sm:ml-6 sm:flex sm:space-x-8">
                        <a href="/" class="border-transparent text-gray-200 hover:border-gray-300 hover:text-white inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium">
                            Dashboard
                        </a>
                        <a href="/experiments" class="border-transparent text-gray-200 hover:border-gray-300 hover:text-white inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium">
                            Experiments
                        </a>
                    </div>
                </div>
                <div class="flex items-center">
                    <a href="/experiments" class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-indigo-700 bg-indigo-100 hover:bg-indigo-200">
                        <i class="fas fa-arrow-left mr-2"></i> Back to Experiments
                    </a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="max-w-7xl mx-auto py-6 sm:px-6 lg:px-8">
        <!-- Header Section -->
        <div class="px-4 py-6 sm:px-0">
            <div class="flex justify-between items-start">
                <div>
                    <h1 class="text-2xl font-bold text-gray-900">{{ experiment.name }}</h1>
                    <p class="mt-2 text-gray-600">{{ experiment.description }}</p>
                    <p class="mt-1 text-sm text-gray-500">Created: {{ experiment.created_at|datetime }}</p>
                </div>
                <div class="flex space-x-3">
                    <a href="/experiment/{{ experiment.id }}/upload" class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700">
                        <i class="fas fa-upload mr-2"></i> Upload Data
                    </a>
                    <a href="/experiment/{{ experiment.id }}/visualize" class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700">
                        <i class="fas fa-chart-line mr-2"></i> Visualize
                    </a>
                    <a href="/experiment/{{ experiment.id }}/train-model" class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700">
                        <i class="fas fa-brain mr-2"></i> Train Model
                    </a>
                </div>
            </div>
        </div>

        <!-- Content Sections -->
        <div class="grid grid-cols-1 gap-6 lg:grid-cols-2">
            <!-- Datasets Section -->
            <div class="bg-white shadow overflow-hidden sm:rounded-lg">
                <div class="px-4 py-5 sm:px-6 flex justify-between items-center">
                    <div>
                        <h2 class="text-lg leading-6 font-medium text-gray-900">Datasets</h2>
                        <p class="mt-1 max-w-2xl text-sm text-gray-500">Data uploaded to this experiment</p>
                    </div>
                    <a href="/experiment/{{ experiment.id }}/upload" class="inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded-md text-indigo-700 bg-indigo-100 hover:bg-indigo-200">
                        <i class="fas fa-plus mr-1"></i> Add Dataset
                    </a>
                </div>
                <div class="border-t border-gray-200">
                    {% if experiment.datasets and experiment.datasets|length > 0 %}
                        <ul class="divide-y divide-gray-200">
                            {% for dataset in experiment.datasets %}
                                <li class="px-4 py-4 sm:px-6 hover:bg-gray-50">
                                    <div class="flex items-center justify-between">
                                        <div class="flex items-center">
                                            <div class="flex-shrink-0 h-10 w-10 bg-indigo-100 rounded-full flex items-center justify-center">
                                                <i class="fas fa-file-csv text-indigo-600"></i>
                                            </div>
                                            <div class="ml-4">
                                                <div class="text-sm font-medium text-gray-900">{{ dataset.filename }}</div>
                                                <div class="text-sm text-gray-500">Added: {{ dataset.created_at|datetime }}</div>
                                            </div>
                                        </div>
                                        <div class="flex space-x-2">
                                            <a href="/dataset/{{ dataset.id }}/visualize" class="inline-flex items-center px-2.5 py-1.5 border border-transparent text-xs font-medium rounded text-indigo-700 bg-indigo-100 hover:bg-indigo-200">
                                                <i class="fas fa-chart-bar mr-1"></i> Visualize
                                            </a>
                                            <button onclick="deleteDataset('{{ experiment.id }}', '{{ dataset.id }}')" class="inline-flex items-center px-2.5 py-1.5 border border-transparent text-xs font-medium rounded text-red-700 bg-red-100 hover:bg-red-200">
                                                <i class="fas fa-trash-alt mr-1"></i> Delete
                                            </button>
                                        </div>
                                    </div>
                                </li>
                            {% endfor %}
                        </ul>
                    {% else %}
                        <div class="px-4 py-5 sm:p-6 text-center">
                            <p class="text-sm text-gray-500">No datasets yet</p>
                            <a href="/experiment/{{ experiment.id }}/upload" class="mt-3 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-indigo-600 bg-indigo-100 hover:bg-indigo-200">
                                <i class="fas fa-upload mr-2"></i> Upload Data
                            </a>
                        </div>
                    {% endif %}
                </div>
            </div>

            <!-- Models Section -->
            <div class="bg-white shadow overflow-hidden sm:rounded-lg">
                <div class="px-4 py-5 sm:px-6 flex justify-between items-center">
                    <div>
                        <h2 class="text-lg leading-6 font-medium text-gray-900">Models</h2>
                        <p class="mt-1 max-w-2xl text-sm text-gray-500">Trained models in this experiment</p>
                    </div>
                    <div class="flex space-x-2">
                        <select id="model-sort" class="text-sm border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500">
                            <option value="date-desc">Newest First</option>
                            <option value="date-asc">Oldest First</option>
                            <option value="r2-desc">Best RÂ² (Highest)</option>
                            <option value="rmse-asc">Best RMSE (Lowest)</option>
                        </select>
                        <a href="/experiment/{{ experiment.id }}/train-model" class="inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded-md text-indigo-700 bg-indigo-100 hover:bg-indigo-200">
                            <i class="fas fa-plus mr-1"></i> Train Model
                        </a>
                    </div>
                </div>
                <div class="border-t border-gray-200">
                    {% if experiment.models and experiment.models|length > 0 %}
                        <ul id="model-list" class="divide-y divide-gray-200">
                            {% for model in experiment.models %}
                                {% set metrics = model.metrics|fromjson if model.metrics else {} %}
                                <li class="px-4 py-4 sm:px-6 hover:bg-gray-50 model-item" 
                                    data-created="{{ model.created_at }}"
                                    data-r2="{{ metrics.r2|default(0) }}"
                                    data-rmse="{{ metrics.rmse|default(9999) }}"
                                    data-type="{{ model.model_type }}"
                                    data-id="{{ model.id }}">
                                    <div class="flex items-center justify-between">
                                        <div class="flex items-center">
                                            <div class="flex-shrink-0 h-10 w-10 bg-green-100 rounded-full flex items-center justify-center">
                                                <i class="fas fa-brain text-green-600"></i>
                                            </div>
                                            <div class="ml-4">
                                                <div class="text-sm font-medium text-gray-900">{{ model.name }}</div>
                                                <div class="text-sm text-gray-500">Type: {{ model.model_type|replace('_', ' ')|title }}</div>
                                                <div class="text-sm text-gray-500">Created: {{ model.created_at|datetime }}</div>
                                            </div>
                                        </div>
                                        <div class="flex space-x-2">
                                            <button onclick="showModelDetails('{{ model.id }}')" class="inline-flex items-center px-2.5 py-1.5 border border-transparent text-xs font-medium rounded text-green-700 bg-green-100 hover:bg-green-200">
                                                <i class="fas fa-info-circle mr-1"></i> Details
                                            </button>
                                            <button onclick="deleteModel('{{ experiment.id }}', '{{ model.id }}', '{{ model.name }}')" class="inline-flex items-center px-2.5 py-1.5 border border-transparent text-xs font-medium rounded text-red-700 bg-red-100 hover:bg-red-200">
                                                <i class="fas fa-trash-alt mr-1"></i> Delete
                                            </button>
                                        </div>
                                    </div>
                                    
                                    <!-- Model Metrics Section -->
                                    <div class="mt-3 pl-14">
                                        <h4 class="text-sm font-medium text-gray-900">Performance Metrics:</h4>
                                        <div class="mt-2 grid grid-cols-2 gap-4 sm:grid-cols-3 lg:grid-cols-4">
                                            {% if 'accuracy' in metrics %}
                                                <!-- Classification Metrics -->
                                                <div class="bg-blue-50 rounded p-2">
                                                    <span class="block text-xs font-medium text-blue-800">Accuracy</span>
                                                    <span class="block text-sm mt-1 font-semibold">{{ "%.4f"|format(metrics.accuracy) }}</span>
                                                </div>
                                                
                                                {% if 'precision' in metrics %}
                                                <div class="bg-blue-50 rounded p-2">
                                                    <span class="block text-xs font-medium text-blue-800">Precision</span>
                                                    <span class="block text-sm mt-1 font-semibold">{{ "%.4f"|format(metrics.precision) }}</span>
                                                </div>
                                                {% endif %}
                                                
                                                {% if 'recall' in metrics %}
                                                <div class="bg-blue-50 rounded p-2">
                                                    <span class="block text-xs font-medium text-blue-800">Recall</span>
                                                    <span class="block text-sm mt-1 font-semibold">{{ "%.4f"|format(metrics.recall) }}</span>
                                                </div>
                                                {% endif %}
                                                
                                                {% if 'f1' in metrics %}
                                                <div class="bg-blue-50 rounded p-2">
                                                    <span class="block text-xs font-medium text-blue-800">F1 Score</span>
                                                    <span class="block text-sm mt-1 font-semibold">{{ "%.4f"|format(metrics.f1) }}</span>
                                                </div>
                                                {% endif %}
                                                
                                            {% elif 'r2' in metrics %}
                                                <!-- Regression Metrics with Enhanced Display -->
                                                <div class="bg-green-50 rounded p-2" 
                                                     title="RÂ² (coefficient of determination) measures how well the model explains the variance in the data. Values range from 0 to 1, with 1 being perfect prediction.">
                                                    <span class="block text-xs font-medium text-green-800">RÂ² Score</span>
                                                    <span class="block text-sm mt-1 font-semibold">{{ "%.4f"|format(metrics.r2) }}</span>
                                                    <span class="block text-xs text-green-700 mt-1">
                                                        {% if metrics.r2 > 0.9 %}Excellent{% elif metrics.r2 > 0.7 %}Good{% elif metrics.r2 > 0.5 %}Fair{% else %}Poor{% endif %}
                                                    </span>
                                                </div>
                                                
                                                <div class="bg-green-50 rounded p-2"
                                                     title="RMSE (Root Mean Squared Error) measures the average magnitude of prediction errors. Lower values indicate better fit.">
                                                    <span class="block text-xs font-medium text-green-800">RMSE</span>
                                                    <span class="block text-sm mt-1 font-semibold">{{ "%.4f"|format(metrics.rmse) }}</span>
                                                </div>
                                                
                                                <div class="bg-green-50 rounded p-2"
                                                     title="MSE (Mean Squared Error) is the average of squared differences between predictions and actual values.">
                                                    <span class="block text-xs font-medium text-green-800">MSE</span>
                                                    <span class="block text-sm mt-1 font-semibold">{{ "%.4f"|format(metrics.mse) }}</span>
                                                </div>
                                                
                                                <!-- Add a metric visualization -->
                                                <div class="bg-gray-50 rounded p-2 flex items-center justify-center">
                                                    <div class="r2-gauge" data-value="{{ metrics.r2 }}"></div>
                                                </div>
                                            {% else %}
                                                <div class="bg-gray-50 rounded p-2 col-span-full">
                                                    <span class="block text-xs font-medium text-gray-500">No metrics available</span>
                                                </div>
                                            {% endif %}
                                        </div>
                                    </div>
                                </li>
                            {% endfor %}
                        </ul>
                    {% else %}
                        <div class="px-4 py-5 sm:p-6 text-center">
                            <p class="text-sm text-gray-500">No models trained yet</p>
                            <a href="/experiment/{{ experiment.id }}/train-model" class="mt-3 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-indigo-600 bg-indigo-100 hover:bg-indigo-200">
                                <i class="fas fa-brain mr-2"></i> Train Model
                            </a>
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- Visualizations Section -->
        <div class="mt-6 bg-white shadow overflow-hidden sm:rounded-lg">
            <!-- Visualizations content here -->
        </div>
    </div>

    <!-- JavaScript for interactive elements -->
    <script>
        // Initialize gauge charts for R2 scores
        document.addEventListener('DOMContentLoaded', function() {
            // Find all R2 gauge elements
            document.querySelectorAll('.r2-gauge').forEach(element => {
                const r2Value = parseFloat(element.dataset.value);
                
                // Create a simple gauge visualization with Plotly
                const data = [{
                    type: "indicator",
                    mode: "gauge",
                    value: r2Value,
                    gauge: {
                        axis: {range: [0, 1]},
                        bar: {color: getColorForR2(r2Value)},
                        steps: [
                            {range: [0, 0.5], color: "rgba(255, 0, 0, 0.1)"},
                            {range: [0.5, 0.7], color: "rgba(255, 165, 0, 0.1)"},
                            {range: [0.7, 0.9], color: "rgba(0, 128, 0, 0.1)"},
                            {range: [0.9, 1], color: "rgba(0, 0, 255, 0.1)"}
                        ],
                        threshold: {
                            line: {color: "black", width: 2},
                            thickness: 0.75,
                            value: r2Value
                        }
                    },
                    title: {text: "RÂ² Score"}
                }];
                
                const layout = {
                    width: 150,
                    height: 150,
                    margin: {t: 25, r: 25, l: 25, b: 25},
                    font: {size: 10}
                };
                
                Plotly.newPlot(element, data, layout, {displayModeBar: false});
            });
        });
        
        // Function to get a color based on R2 value
        function getColorForR2(value) {
            if (value >= 0.9) return "rgb(0, 0, 255)"; // Blue - Excellent
            if (value >= 0.7) return "rgb(0, 128, 0)"; // Green - Good
            if (value >= 0.5) return "rgb(255, 165, 0)"; // Orange - Fair
            return "rgb(255, 0, 0)"; // Red - Poor
        }
        
        // Function to show model details
        function showModelDetails(modelId) {
            // Implementation for showing detailed model information
            // This could open a modal with more metrics and information
            alert(`Showing details for model ${modelId}`);
            // In a real implementation, you would fetch detailed information
            // and display it in a modal or dedicated page
        }
        
        // Function to delete a dataset
        function deleteDataset(experimentId, datasetId) {
            if (confirm('Are you sure you want to delete this dataset? This action cannot be undone.')) {
                fetch(`/api/experiment/${experimentId}/dataset/${datasetId}`, {
                    method: 'DELETE',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        // Reload the page to reflect changes
                        window.location.reload();
                    } else {
                        alert(`Error: ${data.error}`);
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('An error occurred while deleting the dataset');
                });
            }
        }

        // Function to delete a model
        function deleteModel(experimentId, modelId, modelName) {
            if (confirm(`Are you sure you want to delete the model "${modelName}"? This action cannot be undone.`)) {
                // Show a loading indicator
                const modelItem = document.querySelector(`.model-item[data-id="${modelId}"]`);
                if (modelItem) {
                    modelItem.classList.add('opacity-50');
                    modelItem.innerHTML += `
                        <div class="absolute inset-0 flex items-center justify-center bg-white bg-opacity-75">
                            <i class="fas fa-spinner fa-spin text-indigo-600 text-xl"></i>
                        </div>
                    `;
                }
                
                // Send delete request to server
                fetch(`/api/experiment/${experimentId}/model/${modelId}`, {
                    method: 'DELETE',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        // Remove the model item from the DOM with a fade-out effect
                        if (modelItem) {
                            modelItem.style.transition = 'all 0.5s';
                            modelItem.style.maxHeight = '0';
                            modelItem.style.opacity = '0';
                            setTimeout(() => {
                                modelItem.remove();
                                
                                // If no models left, show the empty state
                                const modelList = document.getElementById('model-list');
                                if (modelList && modelList.children.length === 0) {
                                    const modelsSection = modelList.parentNode;
                                    modelsSection.innerHTML = `
                                        <div class="px-4 py-5 sm:p-6 text-center">
                                            <p class="text-sm text-gray-500">No models trained yet</p>
                                            <a href="/experiment/${experimentId}/train-model" class="mt-3 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-indigo-600 bg-indigo-100 hover:bg-indigo-200">
                                                <i class="fas fa-brain mr-2"></i> Train Model
                                            </a>
                                        </div>
                                    `;
                                }
                            }, 500);
                        }
                        
                        // Show success notification
                        showNotification('Model deleted successfully', 'success');
                    } else {
                        // Remove loading state and show error
                        if (modelItem) {
                            modelItem.classList.remove('opacity-50');
                            modelItem.querySelector('.absolute')?.remove();
                        }
                        showNotification(`Error: ${data.error}`, 'error');
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    // Remove loading state
                    if (modelItem) {
                        modelItem.classList.remove('opacity-50');
                        modelItem.querySelector('.absolute')?.remove();
                    }
                    showNotification('An error occurred while deleting the model', 'error');
                });
            }
        }
        
        // Function to show notification
        function showNotification(message, type = 'info') {
            // Create notification element
            const notification = document.createElement('div');
            notification.className = `fixed bottom-4 right-4 px-4 py-2 rounded-lg shadow-lg transition-all duration-500 transform translate-y-10 opacity-0 ${
                type === 'success' ? 'bg-green-100 text-green-800 border border-green-200' :
                type === 'error' ? 'bg-red-100 text-red-800 border border-red-200' :
                'bg-blue-100 text-blue-800 border border-blue-200'
            }`;
            notification.innerHTML = `
                <div class="flex items-center">
                    <i class="mr-2 ${
                        type === 'success' ? 'fas fa-check-circle text-green-500' :
                        type === 'error' ? 'fas fa-exclamation-circle text-red-500' :
                        'fas fa-info-circle text-blue-500'
                    }"></i>
                    <span>${message}</span>
                </div>
            `;
            document.body.appendChild(notification);
            
            // Show notification
            setTimeout(() => {
                notification.classList.remove('translate-y-10', 'opacity-0');
            }, 10);
            
            // Hide notification after 3 seconds
            setTimeout(() => {
                notification.classList.add('translate-y-10', 'opacity-0');
                setTimeout(() => {
                    notification.remove();
                }, 500);
            }, 3000);
        }

        // Function to sort models based on selected criteria
        function sortModels() {
            const sortSelect = document.getElementById('model-sort');
            const modelList = document.getElementById('model-list');
            
            if (!modelList || !sortSelect) return;
            
            const sortValue = sortSelect.value;
            const modelItems = Array.from(document.querySelectorAll('.model-item'));
            
            // Sort the model items based on the selected criteria
            modelItems.sort((a, b) => {
                if (sortValue === 'date-desc') {
                    return new Date(b.dataset.created) - new Date(a.dataset.created);
                } else if (sortValue === 'date-asc') {
                    return new Date(a.dataset.created) - new Date(b.dataset.created);
                } else if (sortValue === 'r2-desc') {
                    // Higher RÂ² is better (descending order)
                    // Only consider regression models for RÂ²
                    const aIsRegression = a.dataset.type.includes('regressor') || a.dataset.type.includes('regression');
                    const bIsRegression = b.dataset.type.includes('regressor') || b.dataset.type.includes('regression');
                    
                    // If one is regression and the other isn't, put regression models first
                    if (aIsRegression && !bIsRegression) return -1;
                    if (!aIsRegression && bIsRegression) return 1;
                    
                    return parseFloat(b.dataset.r2 || 0) - parseFloat(a.dataset.r2 || 0);
                } else if (sortValue === 'rmse-asc') {
                    // Lower RMSE is better (ascending order)
                    // Only consider regression models for RMSE
                    const aIsRegression = a.dataset.type.includes('regressor') || a.dataset.type.includes('regression');
                    const bIsRegression = b.dataset.type.includes('regressor') || b.dataset.type.includes('regression');
                    
                    // If one is regression and the other isn't, put regression models first
                    if (aIsRegression && !bIsRegression) return -1;
                    if (!aIsRegression && bIsRegression) return 1;
                    
                    // Higher values go later (ascending sort)
                    return parseFloat(a.dataset.rmse || 9999) - parseFloat(b.dataset.rmse || 9999);
                }
                return 0;
            });
            
            // Append the sorted items back to the list
            modelItems.forEach(item => {
                modelList.appendChild(item);
            });
            
            // Add visual indicator for sorted items
            highlightSortedModels(sortValue);
        }
        
        // Add visual indicator to show which metric is being used for sorting
        function highlightSortedModels(sortValue) {
            // First, remove any existing highlights
            document.querySelectorAll('.metric-highlight').forEach(el => {
                el.classList.remove('bg-yellow-50', 'border-yellow-200', 'metric-highlight');
            });
            
            // Then add highlight to the relevant metrics
            if (sortValue === 'r2-desc') {
                document.querySelectorAll('.bg-green-50[title*="RÂ²"]').forEach(el => {
                    el.classList.add('bg-yellow-50', 'border-yellow-200', 'border', 'metric-highlight');
                });
            } else if (sortValue === 'rmse-asc') {
                document.querySelectorAll('.bg-green-50[title*="RMSE"]').forEach(el => {
                    el.classList.add('bg-yellow-50', 'border-yellow-200', 'border', 'metric-highlight');
                });
            }
        }
        
        // Add event listener for sort dropdown
        document.addEventListener('DOMContentLoaded', function() {
            const sortSelect = document.getElementById('model-sort');
            if (sortSelect) {
                sortSelect.addEventListener('change', sortModels);
                
                // Initial sort
                sortModels();
            }
            
            // Initialize gauge charts for R2 scores as before
            document.querySelectorAll('.r2-gauge').forEach(element => {
                const r2Value = parseFloat(element.dataset.value);
                
                // Create a simple gauge visualization with Plotly
                const data = [{
                    type: "indicator",
                    mode: "gauge",
                    value: r2Value,
                    gauge: {
                        axis: {range: [0, 1]},
                        bar: {color: getColorForR2(r2Value)},
                        steps: [
                            {range: [0, 0.5], color: "rgba(255, 0, 0, 0.1)"},
                            {range: [0.5, 0.7], color: "rgba(255, 165, 0, 0.1)"},
                            {range: [0.7, 0.9], color: "rgba(0, 128, 0, 0.1)"},
                            {range: [0.9, 1], color: "rgba(0, 0, 255, 0.1)"}
                        ],
                        threshold: {
                            line: {color: "black", width: 2},
                            thickness: 0.75,
                            value: r2Value
                        }
                    },
                    title: {text: "RÂ² Score"}
                }];
                
                const layout = {
                    width: 150,
                    height: 150,
                    margin: {t: 25, r: 25, l: 25, b: 25},
                    font: {size: 10}
                };
                
                Plotly.newPlot(element, data, layout, {displayModeBar: false});
            });
        });
    </script>
</body>
</html>